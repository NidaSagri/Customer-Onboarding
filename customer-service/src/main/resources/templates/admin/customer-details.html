<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Customer Details</title>
<link rel="stylesheet" th:href="@{/css/style.css}">
<style> /* Page-specific styles */
.details-grid {
	display: grid;
	grid-template-columns: 1fr 1fr;
	gap: 20px;
	margin-bottom: 20px;
}

.details-section {
	background: #fff;
	padding: 20px;
	border-radius: 12px;
	box-shadow: var(--card-shadow);
}

.doc-viewer {
	display: flex;
	gap: 20px;
	justify-content: space-around;
	flex-wrap: wrap;
}

.doc-container {
	text-align: center;
}

.doc-container h4 {
	margin-bottom: 10px;
	color: #555;
}

.doc-container img {
	max-width: 150px;
	height: 100px;
	object-fit: cover;
	border: 1px solid #ddd;
	border-radius: 8px;
	cursor: pointer;
}

.doc-container img:hover {
	opacity: 0.8;
}
</style>
</head>
<body>
	<div class="container" style="max-width: 1000px;">
		<div class="logo-container">
			<img
				src="https://img.etimg.com/thumb/width-1200,height-900,imgsize-8519,resizemode-75,msid-114568605/markets/stocks/news/oracle-financial-services-shares-in-focus-after-q2-profit-jumps-38-yoy-to-rs-578-crore.jpg"
				alt="OFSS Bank Logo" />
		</div>
		<div class="header"
			style="justify-content: center; position: relative; border-bottom: none;">
			<h1>
				Review Details for <span th:text="${customer.fullName}"></span>
			</h1>
			<a th:href="@{/admin/dashboard}" class="btn btn-secondary"
				style="position: absolute; right: 0;">Back</a>
		</div>

		<div class="details-grid">
			<div class="details-section">
				<h3>Personal Information</h3>
				<p>
					<strong>Customer ID:</strong> <span th:text="${customer.id}"></span>
				</p>
				<p>
					<strong>Email:</strong> <span th:text="${customer.email}"></span>
				</p>
				<p>
					<strong>Phone:</strong> <span th:text="${customer.phone}"></span>
				</p>
				<p>
					<strong>Date of Birth:</strong> <span
						th:text="${#temporals.format(customer.dob, 'dd-MMM-yyyy')}"></span>
				</p>
				<p>
					<strong>Address:</strong> <span th:text="${customer.address}"></span>
				</p>
			</div>
			<div class="details-section">
				<h3>Identity & Account</h3>
				<p>
					<strong>PAN:</strong> <span th:text="${customer.pan}"></span>
				</p>
				<p>
					<strong>Aadhaar:</strong> <span th:text="${customer.aadhaar}"></span>
				</p>
				<p>
					<strong>KYC Status:</strong> <span class="badge"
						th:classappend="${customer.kycStatus.name()}"
						th:text="${customer.kycStatus}"></span>
				</p>
				<div th:if="${account != null}">
					<hr>
					<p>
						<strong>Account Number:</strong> <span
							th:text="${account.accountNumber}"></span>
					</p>
					<p>
						<strong>Account Type:</strong> <span
							th:text="${account.accountType}"></span>
					</p>
					<p>
						<strong>Account Status:</strong> <span class="badge"
							th:classappend="${account.accountStatus}"
							th:text="${account.accountStatus}"></span>
					</p>
				</div>
				<div th:unless="${account != null}">
					<p>
						<strong>Account Status:</strong> <span class="badge"
							style="background-color: #6c757d;">Not Created</span>
					</p>
				</div>
			</div>
		</div>

		<div class="details-section">
			<h3>Uploaded Documents (Click to View)</h3>
			<div class="doc-viewer">
				<div class="doc-container" th:if="${customer.aadhaarPhotoBase64}">
					<h4>Aadhaar Card</h4>
					<img th:src="${customer.aadhaarPhotoBase64}" alt="Aadhaar Photo"
						onclick="openModal(this.src)" />
				</div>
				<div class="doc-container" th:if="${customer.panPhotoBase64}">
					<h4>PAN Card</h4>
					<img th:src="${customer.panPhotoBase64}" alt="PAN Photo"
						onclick="openModal(this.src)" />
				</div>
				<div class="doc-container" th:if="${customer.passportPhotoBase64}">
					<h4>Passport Photo</h4>
					<img th:src="${customer.passportPhotoBase64}" alt="Passport Photo"
						onclick="openModal(this.src)" />
				</div>
			</div>
		</div>

		<form th:if="${customer.kycStatus.name() == 'PENDING'}"
			th:action="@{/admin/customer/{id}/verify(id=${customer.id})}"
			method="post" class="action-form"
			style="justify-content: center; padding-top: 1rem;">
			<button type="submit" name="approved" value="true"
				class="btn btn-success">Approve KYC</button>
			<button type="submit" name="approved" value="false"
				class="btn btn-danger">Reject KYC</button>
		</form>
	</div>

	<!-- MODAL STRUCTURE -->
	<div id="imageModal" class="modal-overlay" onclick="closeModal()">
		<span class="modal-close">Ã—</span>
		<div class="modal-content" onclick="event.stopPropagation()">
			<img id="modalImage" src="" alt="Document View" />
		</div>
	</div>

	<script
		src="https://cdn.jsdelivr.net/npm/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			const modal = document.getElementById('imageModal');
			const modalImage = document.getElementById('modalImage');
			if (modal && modalImage) {
				const panzoom = Panzoom(modalImage, {
					maxScale : 5,
					canvas : true
				});
				modal.addEventListener('wheel', panzoom.zoomWithWheel);
				window.openModal = function(src) {
					panzoom.reset();
					modalImage.src = src;
					modal.classList.add('active');
				}
				window.closeModal = function() {
					modal.classList.remove('active');
				}
			}
		});
	</script>
</body>
</html>